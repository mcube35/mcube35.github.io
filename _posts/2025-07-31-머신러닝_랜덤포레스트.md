---
title: "ë¨¸ì‹ ëŸ¬ë‹ - ëœë¤í¬ë ˆìŠ¤íŠ¸"
categories: [ë¨¸ì‹ ëŸ¬ë‹, í•™ìŠµ ì „ëµ, ëª¨ë¸ êµ¬ì¡°]
math: true
---

# ğŸŒ³ ëœë¤ í¬ë ˆìŠ¤íŠ¸ (Random Forest)

ëœë¤ í¬ë ˆìŠ¤íŠ¸ëŠ” ì—¬ëŸ¬ ê°œì˜ ê²°ì •ë‚˜ë¬´ë¥¼ ì¡°í•©í•´  
**ì˜ˆì¸¡ ì •í™•ë„ì™€ ì•ˆì •ì„±ì„ ë†’ì´ëŠ” ì•™ìƒë¸” í•™ìŠµ ê¸°ë²•**ì´ë‹¤.  
íšŒê·€ì™€ ë¶„ë¥˜ ëª¨ë‘ì— ì‚¬ìš©ë˜ë©°, **ê³¼ì í•©ì— ê°•í•œ íŠ¹ì„±**ì„ ê°€ì§„ë‹¤.

ì´ ëª¨ë¸ì€ **ë°°ê¹…(Bagging)**ì´ë¼ëŠ” ì „ëµì„ ê¸°ë°˜ìœ¼ë¡œ ì‘ë™í•œë‹¤.

### ğŸ“¦ ë°°ê¹…(Bagging)ì´ë€?

> **ì„œë¡œ ë‹¤ë¥¸ ë°ì´í„° ìƒ˜í”Œë¡œ ì—¬ëŸ¬ ëª¨ë¸ì„ í•™ìŠµì‹œí‚¨ ë’¤**,  
> **ê·¸ ì˜ˆì¸¡ ê²°ê³¼ë¥¼ í‰ê·  ë˜ëŠ” íˆ¬í‘œë¡œ í•©ì¹˜ëŠ” ë°©ë²•**  
> â†’ ê³¼ì í•©ì„ ì¤„ì´ê³ , ë” ì•ˆì •ì ì¸ ì˜ˆì¸¡ì´ ê°€ëŠ¥í•˜ë‹¤.

---

## ğŸ§ª ê²½í—˜: ì§ì ‘ í•´ë³´ê³ , ëˆˆìœ¼ë¡œ ëŠê»´ë³´ê¸°

ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì€ ì¨ë³´ê¸° ì „ê¹Œì§„ ê·¸ ì°¨ì´ë¥¼ ëŠë¼ê¸° ì–´ë µë‹¤.  
**ëœë¤ í¬ë ˆìŠ¤íŠ¸ëŠ” ë‹¨ì¼ ê²°ì •ë‚˜ë¬´ì˜ ì•½ì ì„ ë³´ì™„í•œ ëª¨ë¸**ì´ë¼ ë¶ˆë¦¬ì§€ë§Œ,  
ë§ë§Œ ë“£ê³ ëŠ” ì–¼ë§ˆë‚˜ ë‹¤ë¥¸ì§€ ê°ì´ ì˜ ì˜¤ì§€ ì•ŠëŠ”ë‹¤.

ê·¸ë˜ì„œ ë¨¼ì €,  
**ê°™ì€ ë°ì´í„°ì— ë‘ ëª¨ë¸ì„ ì ìš©í•´ ë³´ê³ **,  
ê·¸ ì°¨ì´ë¥¼ ì§ì ‘ ì²´í—˜í•´ë³´ì.

```python
from sklearn.datasets import make_moons
from sklearn.model_selection import StratifiedKFold
from sklearn.ensemble import RandomForestClassifier
from sklearn.tree import DecisionTreeClassifier
from sklearn.metrics import accuracy_score
import matplotlib.pyplot as plt
import numpy as np

plt.rcParams["font.family"] = "Malgun Gothic"

# 1. ë°ì´í„° ìƒì„±
X, y = make_moons(n_samples=400, noise=0.35, random_state=42)

# 2. ëª¨ë¸ ì •ì˜
tree = DecisionTreeClassifier(max_depth=5, random_state=0)
forest = RandomForestClassifier(n_estimators=100, oob_score=True, random_state=0)

# 3. 18-Fold êµì°¨ê²€ì¦
tree_scores = []
forest_scores = []

cv = StratifiedKFold(n_splits=18, shuffle=True, random_state=42)
for train_idx, test_idx in cv.split(X, y):
    X_train, X_test = X[train_idx], X[test_idx]
    y_train, y_test = y[train_idx], y[test_idx]

    tree.fit(X_train, y_train)
    forest.fit(X_train, y_train)

    tree_scores.append(accuracy_score(y_test, tree.predict(X_test)))
    forest_scores.append(accuracy_score(y_test, forest.predict(X_test)))

# 4. í‰ê·  ì •í™•ë„ ì¶œë ¥
print("ê²°ì •ë‚˜ë¬´ í‰ê·  ì •í™•ë„:", np.mean(tree_scores))
print("ëœë¤ í¬ë ˆìŠ¤íŠ¸ í‰ê·  ì •í™•ë„:", np.mean(forest_scores))

# 5. ì‹œê°í™”
labels = [f"{i+1}í´ë“œ" for i in range(18)]
x = np.arange(18)
width = 0.35

plt.figure(figsize=(8, 4))
plt.bar(x - width/2, tree_scores, width, label='ê²°ì •ë‚˜ë¬´')
plt.bar(x + width/2, forest_scores, width, label='ëœë¤ í¬ë ˆìŠ¤íŠ¸')
plt.xticks(x, labels, rotation=45)
plt.ylim(0.6, 1.0)
plt.ylabel("ì •í™•ë„")
plt.title("18-Fold êµì°¨ê²€ì¦ ì •í™•ë„ ë¹„êµ")
plt.legend()
plt.tight_layout()
plt.show()
````

<img src="../assets/img/2025-07-31-ë¨¸ì‹ ëŸ¬ë‹_ëœë¤í¬ë ˆìŠ¤íŠ¸/1.png" alt="1">

> **êµì°¨ê²€ì¦ ì‹œê°í™”:**
> ëœë¤ í¬ë ˆìŠ¤íŠ¸ëŠ” ì¼ë¶€ í´ë“œë¥¼ ì œì™¸í•˜ë©´ **ëŒ€ì²´ë¡œ ê²°ì •ë‚˜ë¬´ë³´ë‹¤ ìš°ìˆ˜í•˜ë©°**,
> **í‰ê· ì ìœ¼ë¡œ ë” ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ì„±ëŠ¥**ì„ ë³´ì—¬ì¤€ë‹¤.

---

## ğŸ§  ê°œë…: ê²°ì •ë‚˜ë¬´ì™€ ëœë¤ í¬ë ˆìŠ¤íŠ¸ì˜ ì°¨ì´

> ëœë¤ í¬ë ˆìŠ¤íŠ¸ëŠ” **í•­ìƒ ì´ê¸°ì§„ ì•Šì§€ë§Œ**,
> **ê¾¸ì¤€íˆ ì˜í•œë‹¤.** â†’ ê·¸ë˜ì„œ **ì‹ ë¢°í•  ìˆ˜ ìˆë‹¤.**

### ğŸ¯ ì‚¬ê³  ë°©ì‹ì˜ ì°¨ì´

* **ê²°ì •ë‚˜ë¬´**: í•˜ë‚˜ì˜ ê´€ì ìœ¼ë¡œ ê¹Šê²Œ íŒŒê³ ë“¦
  â†’ í•™ìŠµ ë°ì´í„°ì— íŠ¹í™”ë˜ì–´ ì˜ ë§ì¶”ì§€ë§Œ, ìƒˆ ë°ì´í„°ì—” ì‰½ê²Œ í”ë“¤ë¦´ ìˆ˜ ìˆìŒ

* **ëœë¤ í¬ë ˆìŠ¤íŠ¸**: ì—¬ëŸ¬ ê´€ì ì„ ì–•ê²Œ ë³´ê³  í•©ì˜
  â†’ ëœ ë¯¼ê°í•˜ì§€ë§Œ, í‰ê· ì ìœ¼ë¡œ ë” ì•ˆì •ì ì´ê³  ì¼ë°˜í™”ì— ê°•í•¨

> ğŸ“Œ ë¹„ìœ í•˜ìë©´:
> â€œí˜¼ì ì •ë‹µ ì™¸ìš´ ì‚¬ëŒâ€ vs â€œì„œë¡œ í† ë¡ í•´ì„œ íŒë‹¨í•œ ì‚¬ëŒë“¤â€

---

## ğŸŒ² ëœë¤ í¬ë ˆìŠ¤íŠ¸ ì‘ë™ ë°©ì‹

1. **ì—¬ëŸ¬ ê°œì˜ ê²°ì •ë‚˜ë¬´ë¥¼ í•™ìŠµì‹œí‚¨ë‹¤**
2. ê° ë‚˜ë¬´ëŠ” ì„œë¡œ ë‹¤ë¥¸ **ë¶€íŠ¸ìŠ¤íŠ¸ë© ìƒ˜í”Œ**ì„ í•™ìŠµ

   * ì „ì²´ ë°ì´í„°ì—ì„œ **ì¤‘ë³µ í—ˆìš©**í•˜ì—¬ ë¬´ì‘ìœ„ë¡œ ìƒ˜í”Œë§
3. ê° ë…¸ë“œëŠ” ì „ì²´ í”¼ì²˜ ì¤‘ ì¼ë¶€ë§Œ ëœë¤ ì„ íƒí•´ ë¶„í• 
4. ì˜ˆì¸¡ ì‹œ, ëª¨ë“  ë‚˜ë¬´ì˜ ê²°ê³¼ë¥¼ **íˆ¬í‘œ**(ë¶„ë¥˜) ë˜ëŠ” **í‰ê· **(íšŒê·€)

---

## ğŸ§¾ ìš©ì–´ ì„¤ëª…

### ğŸ”¸ ìƒ˜í”Œë§ (Sampling)

* ì „ì²´ ë°ì´í„° ì¤‘ ì¼ë¶€ë¥¼ ë½‘ëŠ” ê²ƒ
* ëœë¤ í¬ë ˆìŠ¤íŠ¸ëŠ” **ì¤‘ë³µ í—ˆìš©** ë¬´ì‘ìœ„ ìƒ˜í”Œë§ì„ ì‚¬ìš© â†’ ì´ë¥¼ **ë¶€íŠ¸ìŠ¤íŠ¸ë© ìƒ˜í”Œ**ì´ë¼ í•¨

> ì˜ˆ: \[A, B, C, D, E] â†’ \[B, C, C, D, A]

### ğŸ”¸ OOB (Out-of-Bag)

* ë¶€íŠ¸ìŠ¤íŠ¸ë© ìƒ˜í”Œì— **ì„ íƒë˜ì§€ ì•Šì€ ë°ì´í„°**
* í•´ë‹¹ ë‚˜ë¬´ëŠ” ì´ ë°ì´í„°ë¥¼ **ë³¸ ì ì´ ì—†ìœ¼ë¯€ë¡œ**, ë§ˆì¹˜ ê²€ì¦ ë°ì´í„°ì²˜ëŸ¼ í™œìš© ê°€ëŠ¥
* ëœë¤ í¬ë ˆìŠ¤íŠ¸ëŠ” ê° ë‚˜ë¬´ì˜ OOB ì˜ˆì¸¡ì„ í‰ê· ë‚´ì–´ ì „ì²´ ëª¨ë¸ì˜ ì„±ëŠ¥ì„ ì¶”ì •í•  ìˆ˜ ìˆìŒ

---

## âœ… ì¥ì  ìš”ì•½

* ê³¼ì í•©ì— ê°•í•¨ (ë‹¤ì–‘í•œ ë‚˜ë¬´ë“¤ì´ ì¡´ì¬í•˜ë¯€ë¡œ)
* ì¼ë°˜í™” ì„±ëŠ¥ ìš°ìˆ˜ (ì•™ìƒë¸” íˆ¬í‘œ/í‰ê· )
* í”¼ì²˜ ì¤‘ìš”ë„ í™•ì¸ ê°€ëŠ¥ (`.feature_importances_`)
* ë³„ë„ ê²€ì¦ì…‹ ì—†ì´ `OOB ì ìˆ˜`ë¡œ ì„±ëŠ¥ ì¸¡ì • ê°€ëŠ¥
* ë³‘ë ¬ ì²˜ë¦¬ì— ì í•©í•¨ (íŠ¸ë¦¬ ê°œë³„ í•™ìŠµ ê°€ëŠ¥)

---

## ğŸ”‘ í•µì‹¬ë§Œ ê¸°ì–µí•˜ë©´

* ëœë¤ í¬ë ˆìŠ¤íŠ¸ëŠ” **ë°°ê¹…(bagging) ê¸°ë°˜ì˜ ì•™ìƒë¸” ëª¨ë¸**
* í•µì‹¬ì€ **ë¶€íŠ¸ìŠ¤íŠ¸ë© + ëœë¤ í”¼ì²˜ ì„ íƒ**
* ì˜ˆì¸¡ì€ **íˆ¬í‘œ or í‰ê· **
* **ë‹¤ì–‘ì„±ì´ ê³§ ì„±ëŠ¥ì´ë‹¤**

---